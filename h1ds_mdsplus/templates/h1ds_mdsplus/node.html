{% extends "h1ds_mdsplus/mdsplus_base.html" %}

<!-- *************************************************************** -->
<!-- ****** Load template tags ************************************* -->
<!-- *************************************************************** -->

<!-- This loads the 'display_data' and 'show_filter' template tags, used
for displaying mds data and H1DS data filters in the template. -->
{% load mdsdata %}

<!-- This loads the 'table' template tag, used for dynamic generation of
HTML tables. -->
{% load templatetable %}

<!-- *************************************************************** -->
<!-- ****** Left panel ********************************************* -->
<!-- *************************************************************** -->

<!-- The left panel includes navigation links for the mdsplus tree: shot
selection,  links to  node descendants  (members and  children), mdsplus
tags and other mdsplus trees. -->
{% block mdscontent %}
<div class="column-thin">
<!--  This generates  the 'select  shot'  form in  the top  left of  the
page. -->
<div class="portlet">
<div class="portlet-header">shot</div>
<div class="portlet-content">
<FORM action="{% url mds-request-shot %}" method="post">{% csrf_token %}
    <span class="left">select shot</span>
    <span class="right">
    <INPUT type="hidden" name="reqpath" value="{{request_fullpath|safe}}">
    <INPUT type="text" size=5 id="requested-shot" name="go_to_shot">
    <INPUT title="go to shot" type="submit" value="&#x21b5;"></span>
 </FORM>
</div></div>
<!-- Generate a table with links to child nodes. -->
<div class="portlet">
<div class="portlet-header">children</div>
<div class="portlet-content">
<table width="100%" class="side-table">
  {% table item mdsnode.children 2 %}
  {% if table.startrow %}
  {% if table.oddrow %}
  <tr class="highlight">
    {% else %}
  <tr>
    {% endif %}
    {% endif %}
    {% if table.lastcellinrow %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}cellAutoAdjust">
      {% else %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}left cellAutoAdjust">
      {% endif %}
      <div class="options displayNone"></div>
      <a href="{{item.1}}">{{item.0}}</a>
    </td>
    {% if table.endrow %}
  </tr>
  {% endif %}
  {% endtable %}
</table>
</div></div>

<!-- Generate  a table with links to  member nodes. -->
<div class="portlet">
<div class="portlet-header">members</div>
<div class="portlet-content">
<table width="100%" class="side-table">
  {% table item mdsnode.members 2 %}
  {% if table.startrow %}
  {% if table.oddrow %}
  <tr class="highlight">
    {% else %}
  <tr>
    {% endif %}
    {% endif %}
    {% if table.lastcellinrow %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}cellAutoAdjust">
      {% else %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}left cellAutoAdjust">
      {% endif %}
      <div class="options displayNone"></div>
      <a href="{{item.1}}">{{item.0}}</a>
    </td>
    {% if table.endrow %}
  </tr>
  {% endif %}
  {% endtable %}
</table>
</div></div>

<!-- Generate a table with links to mdsplus tags. -->
<div class="portlet">
<div class="portlet-header">tags</div>
<div class="portlet-content">
<table width="100%" class="side-table">
  {% table item mdsnode.tagnames 2 %}
  {% if table.startrow %}
  {% if table.oddrow %}
  <tr class="highlight">
    {% else %}
  <tr>
    {% endif %}
    {% endif %}
    {% if table.lastcellinrow %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}cellAutoAdjust">
      {% else %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}left cellAutoAdjust">
      {% endif %}
      <div class="options displayNone"></div>
      <a href="{{item.1}}">{{item.0}}</a>
    </td>
    {% if table.endrow %}
  </tr>
  {% endif %}
  {% endtable %}
</table>
</div></div>
<!--  Generate  a  table  with  links to  mdsplus  trees  recognised  by
H1DS. -->
<div class="portlet">
<div class="portlet-header">trees</div>
<div class="portlet-content">
<table width="100%" class="side-table">
  {% table item mdsnode.treelinks 2 %}
  {% if table.startrow %}
  {% if table.oddrow %}
  <tr class="highlight">
    {% else %}
  <tr>
    {% endif %}
    {% endif %}
    {% if table.lastcellinrow %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}cellAutoAdjust">
      {% else %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}left cellAutoAdjust">
      {% endif %}
      <div class="options displayNone"></div>
      <a href="{{item.1}}">{{item.0}}</a>
    </td>
    {% if table.endrow %}
  </tr>
  {% endif %}
  {% endtable %}
</table>
</div>
</div>
</div>


<!-- *************************************************************** -->
<!-- ****** MDSplus data ******************************************* -->
<!-- *************************************************************** -->


<div class="column-wide">
  <div class="portlet">
    <div class="portlet-header">path</div>
    <div class="portlet-content">
      <div class="centreinfobox"><span class="right"><strong>{{mdsnode.path_breadcrumbs|safe}}</strong></span>
	<span class="left">	<FORM action="{% url mds-request-shot %}" method="post">{% csrf_token %}
	    <INPUT type="hidden" name="reqpath" value="{{request_fullpath|safe}}">
	    <INPUT type="hidden" name="go_to_shot" value="{{mdsnode.shot|add:'-1'}}">
	    <INPUT title="go to shot" type="submit" value="<">
	</FORM></span>
	<span class="left paddedtext"><strong> {{mdsnode.shot}} </strong></span>
	
	<span class="left">	<FORM action="{% url mds-request-shot %}" method="post">{% csrf_token %}
	    <INPUT type="hidden" name="reqpath" value="{{request_fullpath|safe}}">
	    <INPUT type="hidden" name="go_to_shot" value="{{mdsnode.shot|add:'1'}}">
	    <INPUT title="go to shot" type="submit" value=">">
	</FORM></span>
      </div>
      {% block node_error %}{% endblock node_error %}
      </div></div>
  <div class="portlet">
    <div class="portlet-header">data</div>
    <div class="portlet-content">
  
      {% block node_data %}{% display_data mdsnode %}{% endblock node_data %}
    </div>
  </div> <!-- end portlet -->
</div> <!-- end column -->



<!-- *************************************************************** -->
<!-- ****** Right panel ******************************************** -->
<!-- *************************************************************** -->



<div class="column-thin">
<!-- If there is a summary data (SQL) dtype associated with the filtered
data then display a form for adding the data to the summary database -->
{% if perms.h1ds_summary.add_summaryattribute %}
{% if mdsnode.data.summary_dtype %}
<div class="portlet">
<div class="portlet-header">add to summary db</div>
<div class="portlet-content">
  <FORM action="{% url get-summary-attribute-form-from-url %}" method="post">{% csrf_token %}
    <span class="left">add</span>
    <span class="right">
      <INPUT type="hidden" id="url" name="url" value="{% get_absolute_uri %}">
      <INPUT title="add attribute" type="submit" value="&#x21b5;"></span>
  </FORM>
</div></div>
{% endif %}
{% endif %}

<!--  If the  data has  been filtered,  display the  applied  filters in
order, with option to adjust or remove each filter -->
{% if mdsnode.data.filter_history %}
<div class="portlet">
<div class="portlet-header">active filters</div>
<div class="portlet-content">
{% show_active_filters mdsnode %}
</div></div>
{% endif %}

<!-- List the views (H1DS views such as html, json, etc, not django view
functions) available for the node data type -->
<div class="portlet">
<div class="portlet-header">views</div>
<div class="portlet-content">
{% for view_name in mdsnode.data.available_views %}{% show_view view_name %} {% endfor %}
</div></div>

<!--  List the filters  which can  be applied  to the  (possibly already
filtered) data -->

<div class="portlet">
<div class="portlet-header">filters</div>
<div class="portlet-content">
{% show_filters mdsnode %}
</div></div>

<div class="portlet">
<div class="portlet-header">node info</div>
<div class="portlet-content">
{% show_info mdsnode %}
</div>
</div>

</div>
{% endblock mdscontent %}
