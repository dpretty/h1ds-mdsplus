{% extends "h1ds_mdsplus/mdsplus_base.html" %}

{% load templatetable %}
{% block leftpanel %}

<div class="sidebarcontent">
<FORM action="{% url mds-request-shot %}" method="post">{% csrf_token %}
    <span class="left">select shot</span>
    <span class="right">
    <INPUT type="hidden" name="reqpath" value="{{request_fullpath|safe}}">
    <INPUT type="text" size=5 id="requested-shot" name="go_to_shot">
    <INPUT title="go to shot" type="submit" value="&#x21b5;"></span>
 </FORM>
</div>

<h3>children</h3>
<table width="100%" class="side-table">
  {% table item children 2 %}
  {% if table.startrow %}
  {% if table.oddrow %}
  <tr class="highlight">
    {% else %}
  <tr>
    {% endif %}
    {% endif %}
    {% if table.lastcellinrow %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}cellAutoAdjust">
      {% else %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}left cellAutoAdjust">
      {% endif %}
      <div class="options displayNone"></div>
      <a href="{{item.1}}">{{item.0}}</a>
    </td>
    {% if table.endrow %}
  </tr>
  {% endif %}
  {% endtable %}
</table>

<h3>members</h3>
<table width="100%" class="side-table">
  {% table item members 2 %}
  {% if table.startrow %}
  {% if table.oddrow %}
  <tr class="highlight">
    {% else %}
  <tr>
    {% endif %}
    {% endif %}
    {% if table.lastcellinrow %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}cellAutoAdjust">
      {% else %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}left cellAutoAdjust">
      {% endif %}
      <div class="options displayNone"></div>
      <a href="{{item.1}}">{{item.0}}</a>
    </td>
    {% if table.endrow %}
  </tr>
  {% endif %}
  {% endtable %}
</table>

<h3>tags</h3>
<table width="100%" class="side-table">
  {% table item tagnames 2 %}
  {% if table.startrow %}
  {% if table.oddrow %}
  <tr class="highlight">
    {% else %}
  <tr>
    {% endif %}
    {% endif %}
    {% if table.lastcellinrow %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}cellAutoAdjust">
      {% else %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}left cellAutoAdjust">
      {% endif %}
      <div class="options displayNone"></div>
      <a href="{{item.1}}">{{item.0}}</a>
    </td>
    {% if table.endrow %}
  </tr>
  {% endif %}
  {% endtable %}
</table>

<h3>trees</h3>
<table width="100%" class="side-table">
  {% table item treelinks 2 %}
  {% if table.startrow %}
  {% if table.oddrow %}
  <tr class="highlight">
    {% else %}
  <tr>
    {% endif %}
    {% endif %}
    {% if table.lastcellinrow %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}cellAutoAdjust">
      {% else %}
    <td class="{% if table.oddrow %}highlightableCell {% endif %}left cellAutoAdjust">
      {% endif %}
      <div class="options displayNone"></div>
      <a href="{{item.1}}">{{item.0}}</a>
    </td>
    {% if table.endrow %}
  </tr>
  {% endif %}
  {% endtable %}
</table>

{% endblock %}


{% block mdscontent %}
<div class="centreinfobox"><span class="right"><strong>{{path_breadcrumbs|safe}}</strong></span>
<span class="left">	<FORM action="{% url mds-request-shot %}" method="post">{% csrf_token %}
<INPUT type="hidden" name="reqpath" value="{{request_fullpath|safe}}">
	    <INPUT type="hidden" name="go_to_shot" value="{{shot|add:'-1'}}">
	    <INPUT title="go to shot" type="submit" value="<">
	</FORM></span>
<span class="left paddedtext"><strong> {{shot}} </strong></span>

<span class="left">	<FORM action="{% url mds-request-shot %}" method="post">{% csrf_token %}
	    <INPUT type="hidden" name="reqpath" value="{{request_fullpath|safe}}">
	    <INPUT type="hidden" name="go_to_shot" value="{{shot|add:'1'}}">
	    <INPUT title="go to shot" type="submit" value=">">
	</FORM></span>
</div>
{% block node_error %}{% endblock %}
{% block node_data %}
{% endblock %}
{% endblock %}

{% block mdsmeta %}
{% if summary_dtype %}
<div class="sidebarcontent">
<FORM action="{% url get-summary-attribute-form-from-url %}" method="post">{% csrf_token %}
    <span class="left">add to summary database</span>
    <span class="right">
    <INPUT type="hidden" id="url" name="url" value="{{absolute_uri|safe}}">
    <INPUT title="add attribute" type="submit" value="&#x21b5;"></span>
 </FORM>
</div>
{% endif %}
{% if filter_list %}
<h3>applied filters</h3>{% for applied_filter in filter_list %}{{applied_filter|safe}}{% endfor %}
{% endif %}
<h3>views </h3>{% for node_view_name, node_view_link in f_node_views %}<a href="{{node_view_link}}">{{node_view_name}}</a> {% endfor %}
<h3>filters</h3>{% for fdict in f_node_filters %}{{fdict.t|safe}}{% endfor%}
{% endblock mdsmeta%}


{% block extrascript %}
{% comment %}TODO: Move from here? this will get overridden by javascript from signal view.{% endcomment %}

{% if input_tree %}
<script>
function updateLatestShot() {
 $.getJSON('/mdsplus/latest_shot/{{input_tree}}/', function(d){
 $(".latest_shot").text(d.latest_shot);
 }); // end getJSON
} // end function

function autoUpdate() {
setInterval(updateLatestShot, 2000);
}

$(document).ready(function() {
updateLatestShot();
autoUpdate();
});

</script>
{% endif %}
{% endblock %}
